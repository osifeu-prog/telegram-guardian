<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Telegram Guardian  Risk Hygiene</title>
  <style>
    body{font-family:system-ui,Segoe UI,Arial;max-width:980px;margin:40px auto;padding:0 16px;line-height:1.5}
    code,pre{background:#f6f8fa;padding:2px 6px;border-radius:6px}
    pre{padding:12px;overflow:auto}
    .card{border:1px solid #e5e7eb;border-radius:14px;padding:16px;margin:14px 0}
    .muted{color:#6b7280}
    a{color:#2563eb;text-decoration:none}
    a:hover{text-decoration:underline}
    table{border-collapse:collapse;width:100%}
    th,td{border-bottom:1px solid #eee;padding:8px;text-align:left;font-size:14px}
  </style>
</head>
<body>
  <h1>Telegram Guardian  Risk Hygiene</h1>
  <p class="muted">
    Local-only tool that scans your Telegram dialogs (read-only) and generates a risk hygiene report.
    This public page uses <b>synthetic data</b>.
  </p>

  <div class="card">
    <h2>What it does</h2>
    <ul>
      <li>Scan dialogs locally  <code>out/scan_report.json</code></li>
      <li>Compute risk score per dialog  <code>out/risk_report.csv</code></li>
      <li>Apply policy layers: Ignore + Whitelist</li>
      <li>Excel-friendly output  <code>out/risk_report.excel.csv</code></li>
    </ul>
  </div>

  <div class="card">
    <h2>Run (local)</h2>
    <pre>powershell -NoProfile -ExecutionPolicy Bypass -File .\scripts\run_all.ps1</pre>
  </div>

  <div class="card">
    <h2>Demo CSV (synthetic)</h2>
    <p><a href="./demo_risk_report.csv">Download demo_risk_report.csv</a></p>
    <div id="tbl"></div>
  </div>

<script>
async function loadCsv() {
  const res = await fetch('./demo_risk_report.csv');
  const text = await res.text();
  const lines = text.trim().split(/\r?\n/);
  const headers = lines[0].split(',');

  const rows = lines.slice(1).map(l => {
    const parts = [];
    let cur="", inq=false;
    for (let i=0;i<l.length;i++){
      const c=l[i];
      if(c === '"'){ inq=!inq; continue; }
      if(c === ',' && !inq){ parts.push(cur); cur=""; continue; }
      cur+=c;
    }
    parts.push(cur);
    const obj={};
    headers.forEach((h,idx)=>obj[h]=parts[idx] ?? "");
    return obj;
  });

  const table = document.createElement('table');
  const thead = document.createElement('thead');
  const trh = document.createElement('tr');
  headers.forEach(h=>{
    const th=document.createElement('th'); th.textContent=h; trh.appendChild(th);
  });
  thead.appendChild(trh);
  table.appendChild(thead);

  const tbody=document.createElement('tbody');
  rows.forEach(r=>{
    const tr=document.createElement('tr');
    headers.forEach(h=>{
      const td=document.createElement('td'); td.textContent=r[h]; tr.appendChild(td);
    });
    tbody.appendChild(tr);
  });
  table.appendChild(tbody);

  document.getElementById('tbl').appendChild(table);
}
loadCsv();
</script>
</body>
</html>
